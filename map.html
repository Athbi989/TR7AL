<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trhal</title>
    <link rel="icon" href="./globe.png" />
    <!-- Awesome Fonts (For Icons only) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css" />
    <!-- My Style's CSS -->
    <link rel="stylesheet" href="./assets/css/main.css" />
    <link rel="stylesheet" href="./assets/css/helpers.css" />
    <link rel="stylesheet" href="./assets/css/forms.css" />
    <style>
      /* Force Adjust Maps */

      #map-canvas {
        width: 100%;
        height: 100%;
        position: static !important;
        overflow: hidden;
        -moz-transition: none;
        -webkit-transition: none;
        -o-transition: all 0s ease;
        transition: none;
      }

      @media only screen and (max-width: 600px) {
        #alert {
          display: block !important;
        }

        #tip {
          display: none !important;
        }

        #map-canvas {
          display: none !important;
        }
      }
    </style>
  </head>

  <body dir="rtl">
    <!-- Preloader -->
    <div id="loader-wrapper">
      <div id="loader"></div>
      <div class="loader-section section-left"></div>
      <div class="loader-section section-right"></div>
    </div>
    <!-- Main - Header (flexboxed) -->
    <header>
      <div class="flex-header">
        <!-- Right side of header -->
        <div class="right-side">
          <div class="tilte-container">
            <h1>تّرحال</h1>
            <img width="42" src="./globe.png" alt="" />
          </div>
        </div>
        <!-- Left side of header -->
        <div class="left-side">
          <!-- User Settings Labels -->
          <div class="dropdown">
            <button class="btn btn-light dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="./assets/flags/kw.png" width="16" /> دينار</button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#"><img src="./assets/flags/kw.png" width="16" /> دينار </a>
              <a class="dropdown-item" href="#"><img src="./assets/flags/ae.png" width="16" /> درهم </a>
              <a class="dropdown-item" href="#"><img src="./assets/flags/sa.png" width="16" /> ريال </a>
            </div>
          </div>
          <!-- Light Dark Switcher -->
          <div class="SwitcherDiv">
            <input type="checkbox" class="modrenSwitch" onchange="switchTheme(this.checked)" id="chk" />
            <label class="switch" for="chk">
              <i class="fas fa-moon"></i>
              <i class="fas fa-sun"></i>
              <div class="ball"></div>
            </label>
          </div>
        </div>
      </div>
    </header>

    <!-- Sidebar (flexboxed) -->
    <nav class="navbar-trhal">
      <ul class="navbar-nav">
        <li class="logo">
          <a href="#" class="nav-link">
            <span class="link-text logo-text">Hive it </span>
            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plane-departure" class="svg-inline--fa fa-plane-departure fa-w-20" role="img" viewBox="0 0 640 512">
              <path
                fill="currentColor"
                d="M624 448H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h608c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM80.55 341.27c6.28 6.84 15.1 10.72 24.33 10.71l130.54-.18a65.62 65.62 0 0 0 29.64-7.12l290.96-147.65c26.74-13.57 50.71-32.94 67.02-58.31 18.31-28.48 20.3-49.09 13.07-63.65-7.21-14.57-24.74-25.27-58.25-27.45-29.85-1.94-59.54 5.92-86.28 19.48l-98.51 49.99-218.7-82.06a17.799 17.799 0 0 0-18-1.11L90.62 67.29c-10.67 5.41-13.25 19.65-5.17 28.53l156.22 98.1-103.21 52.38-72.35-36.47a17.804 17.804 0 0 0-16.07.02L9.91 230.22c-10.44 5.3-13.19 19.12-5.57 28.08l76.21 82.97z"
              />
            </svg>
          </a>
        </li>
        <!-- Sidebar Items (also flexboxed) -->
        <li class="nav-item">
          <a href="./index.html" class="nav-link">
            <i class="fa fa-home clx"></i>
            <span class="side-menu__label">رئيسي</span>
            <!-- <span class="nav-tip">الصفحة الرئيسية</span> -->
          </a>
        </li>

        <li class="nav-item">
          <a href="./popular.html" class="nav-link">
            <i class="fas fa-fire clx"></i>
            <span class="side-menu__label">الشائع</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="./explore.html" class="nav-link">
            <i class="fas fa-search clx"></i>
            <span class="side-menu__label">إكتشف</span>
          </a>
        </li>

        <li class="nav-item nav-active">
          <a href="./map.html" class="nav-link">
            <i class="fas fa-map clx"></i>
            <span class="side-menu__label">الخريطة</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="./hotels.html" class="nav-link">
            <i class="fas fa-hotel clx"></i>
            <span class="side-menu__label">الفنادق</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="./flights.html" class="nav-link">
            <i class="fas fa-plane clx"></i>
            <span class="side-menu__label">الطيران</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="./currency.html" class="nav-link">
            <i class="fas fa-coins clx"></i>
            <span class="side-menu__label">العملات</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="./covid19.html" class="nav-link">
            <i class="fas fa-pills clx"></i>
            <span class="side-menu__label">كوفيد-19</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="#" class="nav-link">
            <span class="side-menu__label"></span>
          </a>
        </li>
      </ul>
    </nav>

    <main>
      <!-- All Page Content gose her -->
      <div class="tip-container">
        <div class="tip" id="tip">
          <i class="fas fa-lightbulb"></i>
          اذا ضغطت على الدولة سوف ينقلك للصفحة الخاصه فيها
        </div>
        <div class="tip tip-colmun" id="tip">
          <i class="fas fa-lightbulb"></i>
          هل تود معرفه موقعك ؟
          <button class="button" style="width: 100%; padding: 0px" onclick="getMyCurrentLocation ()">اضغط هنا لتحديد موقعك</button>
        </div>

        <div class="tip tip-danger" style="display: none" id="alert">
          <i class="fas fa-lightbulb"></i>
          عذرا الخريطه لاتعمل بكفاءة بالشاشات الصغيرة
        </div>
      </div>
      <div id="map-canvas" style="width: 100%; height: 100%"></div>
    </main>
    <script src="./assets/js/jquery.min.js"></script>
    <script src="./assets/js/main.js"></script>
    <script src="./assets/js/countries.js"></script>
    <script src="./assets/js/forms.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB73ruVbZGoirOrvFzCec4T92XZWxFdcic"></script>

    <script>
      var map;
      $(document).ready(function () {
        let countries = [];
        let mapOptions = "";
        const themeMode = localStorage.getItem("theme");

        mapOptions = {
          zoom: 3,
          minZoom: 3,
          center: new google.maps.LatLng(29.3117, 47.4818),
          mapTypeId: google.maps.MapTypeId.ROADMAP,
          backgroundColor: "none",
        };

        if (themeMode != null) {
          if (themeMode == "dark") {
            mapOptions = {
              zoom: 3,
              minZoom: 3,
              center: new google.maps.LatLng(29.3117, 47.4818),
              mapTypeId: google.maps.MapTypeId.ROADMAP,
              styles: [
                { elementType: "geometry", stylers: [{ color: "#242f3e" }] },
                { elementType: "labels.text.stroke", stylers: [{ color: "#242f3e" }] },
                { elementType: "labels.text.fill", stylers: [{ color: "#746855" }] },
                {
                  featureType: "administrative.locality",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#d59563" }],
                },
                {
                  featureType: "poi",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#d59563" }],
                },
                {
                  featureType: "poi.park",
                  elementType: "geometry",
                  stylers: [{ color: "#263c3f" }],
                },
                {
                  featureType: "poi.park",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#6b9a76" }],
                },
                {
                  featureType: "road",
                  elementType: "geometry",
                  stylers: [{ color: "#38414e" }],
                },
                {
                  featureType: "road",
                  elementType: "geometry.stroke",
                  stylers: [{ color: "#212a37" }],
                },
                {
                  featureType: "road",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#9ca5b3" }],
                },
                {
                  featureType: "road.highway",
                  elementType: "geometry",
                  stylers: [{ color: "#746855" }],
                },
                {
                  featureType: "road.highway",
                  elementType: "geometry.stroke",
                  stylers: [{ color: "#1f2835" }],
                },
                {
                  featureType: "road.highway",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#f3d19c" }],
                },
                {
                  featureType: "transit",
                  elementType: "geometry",
                  stylers: [{ color: "#2f3948" }],
                },
                {
                  featureType: "transit.station",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#d59563" }],
                },
                {
                  featureType: "water",
                  elementType: "geometry",
                  stylers: [{ color: "#17263c" }],
                },
                {
                  featureType: "water",
                  elementType: "labels.text.fill",
                  stylers: [{ color: "#515c6d" }],
                },
                {
                  featureType: "water",
                  elementType: "labels.text.stroke",
                  stylers: [{ color: "#17263c" }],
                },
              ],
              backgroundColor: "none",
            };
          }
        }
        map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
        $("#map-canvas").css("position", "fixed !important");

        init();

        function init() {
          $.ajax({
            url: "./assets/js/data.json",
            cache: true,
            dataType: "json",
            async: true,

            success: function (data) {
              if (data) {
                $.each(
                  data,
                  function (id, country) {
                    var countryCoords;
                    var ca;
                    var co;

                    if ("multi" in country) {
                      var ccArray = [];

                      for (var t in country["xml"]["Polygon"]) {
                        countryCoords = [];

                        co = country["xml"]["Polygon"][t]["outerBoundaryIs"]["LinearRing"]["coordinates"].split(" ");

                        for (var i in co) {
                          ca = co[i].split(",");

                          countryCoords.push(new google.maps.LatLng(ca[1], ca[0]));
                        }

                        ccArray.push(countryCoords);
                      }

                      createCountry(ccArray, country);
                    } else {
                      countryCoords = [];

                      co = country["xml"]["outerBoundaryIs"]["LinearRing"]["coordinates"].split(" ");

                      for (var j in co) {
                        ca = co[j].split(",");

                        countryCoords.push(new google.maps.LatLng(ca[1], ca[0]));
                      }

                      createCountry(countryCoords, country);
                    }
                  }.bind(this)
                );

                showCountries();
              }
            }.bind(this),
          });
        }

        function showCountries() {
          for (var i = 0; i < countries.length; i++) {
            countries[i].setMap(map);

            google.maps.event.addListener(countries[i], "mouseover", function () {
              this.setOptions({ fillColor: "#3b3085", fillOpacity: 0.5 });
            });

            google.maps.event.addListener(countries[i], "mouseout", function () {
              this.setOptions({ fillColor: "#f5c879", fillOpacity: 0 });
            });

            google.maps.event.addListener(countries[i], "click", function (event) {
              window.location = "./view.html?id=" + this.code;
            });
          }
        }

        function createCountry(coords, country) {
          var currentCountry = new google.maps.Polygon({
            paths: coords,
            //strokeColor: 'white',
            title: country.country,
            code: country.iso,
            strokeOpacity: 0,
            //strokeWeight: 1,
            //fillColor: country['color'], // can be used as default color
            fillOpacity: 0,
          });

          countries.push(currentCountry);
        }
      });

      function getMyCurrentLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(success, error);
        } else {
          alert("لم نستطع الوصول الي موقعك");
        }
      }

      function success(position) {
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;
        map.setCenter(new google.maps.LatLng(lat, lng));
        map.setZoom(5);
      }

      function error(msg) {
        alert("لم نستطع الوصول الي موقعك");
      }
    </script>
  </body>
</html>
